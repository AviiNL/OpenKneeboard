<Page
  x:Class="OpenKneeboardApp.GameSettingsPage"
  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:local="using:OpenKneeboardApp"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  mc:Ignorable="d"
  Background="{ThemeResource SystemChromeMediumLowColor}">
  <Page.Resources>
    <!-- Generic Games -->
    <DataTemplate x:Key="GenericGameTemplate" x:DataType="local:GameInstanceUIData">
      <Expander HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
        <Expander.Header>
          <Grid ColumnDefinitions="Auto,*">
            <Grid
              Grid.Column="0"
              Margin="0,8,8,8"
              Height="48"
              Width="48"
              CornerRadius="8"
              Background="{ThemeResource SolidBackgroundFillColorSecondaryBrush}">
              <Image Height="32" Width="32" Source="{x:Bind Icon}" />
            </Grid>
            <TextBlock
              Grid.Column="1"
              Style="{StaticResource BodyStrongTextBlockStyle}"
              Text="{x:Bind Name}"
              VerticalAlignment="Center"
            />
          </Grid>
        </Expander.Header>
        <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto" ColumnSpacing="8">
          <Button
            Grid.Row="0"
            Grid.Column="2"
            Grid.RowSpan="2"
            VerticalAlignment="Top"
            Tag="{x:Bind InstanceID}"
            Click="RemoveGame">
            <SymbolIcon Symbol="Delete" />
          </Button>
          <TextBlock Grid.Row="0" Grid.Column="0" Style="{ThemeResource BodyStrongTextBlockStyle}">Type:</TextBlock>
          <TextBlock Grid.Row="0" Grid.Column="1" Style="{ThemeResource BodyTextBlockStyle}" Text="{x:Bind Type}" />
          <TextBlock Grid.Row="1" Grid.Column="0" Style="{ThemeResource BodyStrongTextBlockStyle}">Path:</TextBlock>
          <TextBlock Grid.Row="1" Grid.Column="1" Style="{ThemeResource BodyTextBlockStyle}" Text="{x:Bind Path}" />
        </Grid>
      </Expander>
    </DataTemplate>
    <!-- DCS World -->
    <DataTemplate x:Key="DCSWorldTemplate" x:DataType="local:DCSWorldInstanceUIData">
      <Expander HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch">
        <Expander.Header>
          <Grid ColumnDefinitions="Auto,*">
            <Grid
              Grid.Column="0"
              Grid.RowSpan="2"
              Margin="0,8,8,8"
              Height="48"
              Width="48"
              CornerRadius="8"
              Background="{ThemeResource SolidBackgroundFillColorSecondaryBrush}">
              <Image Height="32" Width="32" Source="{x:Bind Icon}" />
            </Grid>
            <TextBlock
              Grid.Column="1"
              Style="{StaticResource BodyStrongTextBlockStyle}"
              Text="{x:Bind Name}"
              VerticalAlignment="Center"
            />
          </Grid>
        </Expander.Header>
        <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto,Auto,Auto" ColumnSpacing="8" RowSpacing="8">
          <Button
            Grid.Row="0"
            Grid.Column="2"
            Grid.RowSpan="3"
            VerticalAlignment="Top"
            Tag="{x:Bind InstanceID}"
            Click="RemoveGame">
            <SymbolIcon Symbol="Delete" />
          </Button>
          <TextBlock Grid.Row="0" Grid.Column="0" Style="{ThemeResource BodyStrongTextBlockStyle}">Type:</TextBlock>
          <TextBlock Grid.Row="0" Grid.Column="1" Style="{ThemeResource BodyTextBlockStyle}" Text="{x:Bind Type}" />
          <TextBlock Grid.Row="1" Grid.Column="0" Style="{ThemeResource BodyStrongTextBlockStyle}">Path:</TextBlock>
          <TextBlock Grid.Row="1" Grid.Column="1" Style="{ThemeResource BodyTextBlockStyle}" Text="{x:Bind Path}" />
          <TextBlock Grid.Row="2" Grid.Column="0" Style="{ThemeResource BodyStrongTextBlockStyle}" VerticalAlignment="Center">Rendering API:</TextBlock>
          <ComboBox
            Grid.Row="2" Grid.Column="1"
            Tag="{x:Bind InstanceID}"
            SelectedIndex="{x:Bind OverlayAPI}"
            SelectionChanged="OnOverlayAPIChanged">
            <x:String>Auto-detect</x:String>
            <x:String>SteamVR</x:String>
            <x:String>Oculus + Direct3D 11</x:String>
            <x:String>Oculus + Direct3D 12</x:String>
            <x:String>Direct3D 11 (Non-VR)</x:String>
          </ComboBox>
          <TextBlock
            Grid.Row="3" Grid.Column="0"
            VerticalAlignment="Center"
            Style="{ThemeResource BodyStrongTextBlockStyle}">
            Saved Games:
          </TextBlock>
          <HyperlinkButton
            Grid.Row="3" Grid.Column="1"
            VerticalAlignment="Center"
            Tag="{x:Bind InstanceID}"
            Content="{x:Bind SavedGamesPath}"
            Click="ChangeDCSSavedGamesPath"
          />
        </Grid>
      </Expander>
    </DataTemplate>
  </Page.Resources>
  <Grid Margin="0,0,0,16" RowDefinitions="Auto,*">
    <CommandBar Grid.Row="0" DefaultLabelPosition="Right">
      <AppBarButton Icon="Add" Label="Add a Game">
        <AppBarButton.Flyout>
          <MenuFlyout>
            <MenuFlyoutItem
              Click="AddRunningProcess"
              Text="Add a game that's running">
              <MenuFlyoutItem.Icon>
                <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE768;"/>
              </MenuFlyoutItem.Icon>
            </MenuFlyoutItem>
            <MenuFlyoutItem Text="Add an exe file" Click="AddExe">
              <MenuFlyoutItem.Icon>
                <FontIcon FontFamily="{StaticResource SymbolThemeFontFamily}" Glyph="&#xE838;"/>
              </MenuFlyoutItem.Icon>
            </MenuFlyoutItem>
          </MenuFlyout>
        </AppBarButton.Flyout>
      </AppBarButton>
    </CommandBar>
    <ItemsRepeater Grid.Row="1" ItemsSource="{x:Bind Games, Mode=OneWay}" Margin="8,8,8,8">
      <ItemsRepeater.Layout>
        <StackLayout Orientation="Vertical" Spacing="8" />
      </ItemsRepeater.Layout>
      <ItemsRepeater.ItemTemplate>
        <local:GameInstanceUIDataTemplateSelector
          GenericGame="{StaticResource GenericGameTemplate}"
          DCSWorld="{StaticResource DCSWorldTemplate}"
        />
      </ItemsRepeater.ItemTemplate>
    </ItemsRepeater>
  </Grid>
</Page>
